{% extends "product/product_base.html" %}

{% load staticfiles %}

{% load cloudinary %}

{% block stylesheets %}
	<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{% block content %}
	<div id="profile-block">
		<h2> Profile for user "{{ member.user.username }}" </h2>
		<div id="profile-left">
			<strong style="margin-bottom:130px"> Profile picture </strong>
			<strong> Display name </strong>
			<strong> Quote </strong>
			<strong> Bio </strong>
		</div>
		<div id="profile-right">
			<form method="post" action="{% url 'update_user' username=member.user.username %}" enctype="multipart/form-data">
				{% csrf_token %}

				{% if posted %}
					{% cloudinary posted.profile_image THUMBNAIL %}
			      	<div class="results">
			        {% if errors %}
			          	Errors: {{ errors }}
			        {% endif %}
			      	</div>
				{% endif %}
				<div id="cloudinary-input-block">
					{% if member.profile_image %}
						{% cloudinary member.profile_image THUMBNAIL %}
						<div id="profile-pic-info">
							<p>Currently: <a href="{{ member.profile_image.url }}">{{ member.profile_image.public_id }}</a></p>
							<input id="id_profile_image" name="profile_image" type="file">
						</div>
					{% else %}
						<img src="http://livestockportal.co.ke/img/blank_profile.png" alt="profile-pic" width="120" height="120">
						<div id="profile-pic-info">
							<p>Currently: None</p>
							<input id="id_profile_image" name="profile_image" type="file">
						</div>
					{% endif %}
				</div>

				<input id="id_display_name" class="form-control full" maxlength="60" name="display_name" type="text" value="{{ member.display_name }}"><br>

				<input id="id_quote" class="form-control full" maxlength="300" name="quote" type="text" value="{{ member.quote }}"><br>
				
				<textarea cols="40" class="form-control full" id="id_bio" name="bio" rows="10">{{ member.bio }}</textarea><br>
				
				<input type="submit" value="Save" class="btn btn-primary">
				<!--
				<div class="profile-info-block">
					<div id="inner-one">
						<input id="id_profile_image" name="profile_image" type="file">
					</div>
				</div>
				<div class="profile-info-block">
					<div id="inner-two">
						<input id="id_display_name" maxlength="500" name="display_name" type="text" class="form-control" placeholder="Enter display name" style="width:463px;float:left" value="{{ member.display_name }}"><br><br>
					</div>
				</div>
				<div class="profile-info-block">
					<div id="inner-three">
						<input id="id_quote" maxlength="500" name="quote" type="text" class="form-control" placeholder="Enter quote" style="width:463px;float:left" value="{{ member.quote }}"><br><br>
					</div>
				</div>
				<div class="profile-info-block">
					<div id="inner-four">
						<textarea id="id_bio" maxlength="1000" name="bio" class="form-control" style="height:200px;float:left;margin-bottom:23px;width:463px">{{ member.bio }}</textarea><br><br><br>
					</div>
				</div>
				<p><input type="submit" value="Save!" /></p>
				-->
			</form>
		</div>
	</div>

	<div id="user-referrals">
		<table class="table datatable" id="all-links">
			<thead>
				<tr>
					<th>Link Title</th>
					<th>Clicks</th>
					<th>Purchases</th>
					<th>Submitted</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
{% endblock %}

{% block javascript %}
	<script type="text/javascript"?>
		$(document).ready(function() {
			// datatables init
			var oTable = $('.datatable').dataTable({
				// ...
                "iDisplayLength": 25,
                "aaSorting": [[ 0, "desc" ]],
	 			"bProcessing": false,
				"bServerSide": false,
				"bSortable": true,
				"bFilter": false,
				"bPaginate": true,
				"aoColumnDefs": [
                    { "sWidth": "160px", "aTargets": [0], },
                    { "sWidth": "30px", "aTargets": [1], },
                    { "sWidth": "30px", "aTargets": [2], },
                    { "sWidth": "68px", "aTargets": [3], "iDataSort": 5},
                    { "sWidth": "90px", "aTargets": [4], "bSortable": false, },
                    { "bVisible": false, "aTargets": [5]}
                ],
                "sAjaxSource": "/datatables/all-refs/?username={{ user.username }}",

			});
		});	</script>



{% endblock %}